@inherits WindowContentComponentBase
@inject ValourClient Client
@inject PlanetService PlanetService
@inject FriendService FriendService
@inject ChannelStateService ChannelStateService
@inject UnreadService UnreadService

<div class="inner-window @_mobileTag">
    <h6 class="mt-4 text-center icons-title">Your Planets</h6>
    <div class="icon-container">
        @foreach (Planet planet in PlanetService.JoinedPlanets)
        {
            <PlanetCardComponent @key='"joined-" + planet.Id' Planet='planet' WindowCtx='WindowCtx' HomeWindowComponent="this"></PlanetCardComponent>
        }
        <div id="flipper-planet-create-@WindowCtx.Id" class="flipper" ontouchstart="determineFlip('flipper-planet-create-@WindowCtx.Id', 240)" onmouseover="determineFlip('flipper-planet-create-@WindowCtx.Id', 240)" @onclick="OnClickCreatePlanet">
            <div class="outer-circle">
                <div class="text-hide-circle"></div>
                <svg class="icon create" style="border-radius: 0; transform: scale(0.7)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500">
                    <defs>
                        <style>
                        .cls-1, .cls-3 {
                            fill: #fff;
                        }

                        .cls-1 {
                            opacity: 0.1;
                        }

                        .cls-2 {
                            opacity: 0.2;
                        }

                        .cls-4 {
                            fill: #05ff00;
                        }
                    </style>
                    </defs>
                    <g id="Layer_2" data-name="Layer 2"><g id="Layer_4" data-name="Layer 4"><g id="Ocean"><path class="cls-1" d="M393.24,421.55a5,5,0,0,0-4.95-4.95H347.41a5,5,0,0,1-5-5V398.19a5,5,0,0,1,5-4.95h40.88a5,5,0,0,0,4.95-4.95V347.41a5,5,0,0,1,5-5h13.44a5,5,0,0,1,5,5v40.88a5,5,0,0,0,4.95,4.95H454.9A248.85,248.85,0,0,0,500,250C500,111.93,388.07,0,250,0S0,111.93,0,250,111.93,500,250,500a248.85,248.85,0,0,0,143.24-45.1Z"/><path class="cls-1" d="M421.55,416.6a5,5,0,0,0-4.95,4.95v14.83a252.85,252.85,0,0,0,19.78-19.78Z"/></g><g id="Landmass" class="cls-2"><path class="cls-3" d="M421.55,416.6a5,5,0,0,0-4.95,4.95v14.8c.92-.83,1.85-1.64,2.76-2.47h0l.72-.67q1.69-1.57,3.36-3.18l1.13-1.1c1-1,2.08-2,3.1-3.07.46-.46.91-.93,1.36-1.39.93-1,1.85-1.91,2.77-2.88l1.54-1.65c.84-.91,1.69-1.83,2.52-2.75l.54-.59Z"/><path class="cls-3" d="M499.9,243.17c0-.75-.06-1.5-.08-2.25-.06-1.52-.11-3-.19-4.54-.05-.89-.12-1.78-.17-2.67-.09-1.36-.18-2.72-.29-4.08-.08-.94-.16-1.88-.25-2.81-.12-1.3-.25-2.61-.39-3.9-.1-.95-.21-1.9-.32-2.85-.15-1.28-.32-2.56-.49-3.84l-.39-2.81c-.19-1.29-.39-2.58-.6-3.86l-.45-2.72c-.24-1.33-.49-2.66-.74-4-.16-.84-.31-1.68-.48-2.52-.3-1.48-.62-3-.95-4.43l-.36-1.71h0C468.38,83,368.89,0,250,0a249.5,249.5,0,0,0-88.28,16.05h0l-2.06.8-2,.77c-1.26.5-2.51,1-3.76,1.53l-1.52.64q-2.66,1.11-5.26,2.3l-.24.1q-2.47,1.13-4.92,2.3l-1.57.77c-1.19.58-2.36,1.16-3.53,1.76-.62.31-1.23.63-1.84.95l-3.23,1.7-1.88,1c-1.07.59-2.13,1.18-3.19,1.79l-1.79,1c-1.15.67-2.29,1.35-3.42,2-.49.29-1,.57-1.45.87q-2.43,1.47-4.81,3l-.18.11q-2.28,1.47-4.52,3l-1.52,1-3.13,2.17-1.74,1.25c-1,.68-1.9,1.37-2.85,2.07l-1.78,1.33c-.93.71-1.87,1.43-2.79,2.15-.57.43-1.13.87-1.69,1.31q-1.5,1.18-3,2.4l-1.41,1.14-.35.29h0A250.84,250.84,0,0,0,50.6,99.21v0l-.52.71-1.13,1.51c-.74,1-1.48,2-2.21,3L45.6,106c-.75,1.07-1.49,2.14-2.23,3.22l-.94,1.38c-1,1.49-2,3-3,4.49a1.3,1.3,0,0,0-.1.15q-1.53,2.39-3,4.81c-.24.39-.47.79-.71,1.19-.73,1.21-1.45,2.42-2.16,3.65l-.87,1.53c-.66,1.15-1.31,2.32-2,3.49-.28.49-.55,1-.82,1.49q-1.07,2-2.09,4c-.18.34-.36.67-.53,1q-1.3,2.57-2.57,5.17l-.12.26c-.77,1.6-1.52,3.22-2.26,4.84-.21.45-.41.91-.61,1.37-.58,1.28-1.14,2.57-1.69,3.86l-.66,1.56c-.55,1.3-1.08,2.61-1.6,3.92-.19.46-.38.93-.56,1.39-.65,1.67-1.3,3.35-1.92,5l-.09.26q-1,2.74-1.94,5.52c-.12.34-.23.68-.34,1-.49,1.46-1,2.93-1.43,4.41-.17.53-.33,1.06-.5,1.6-.4,1.32-.8,2.64-1.18,4l-.48,1.67c-.4,1.42-.78,2.85-1.16,4.29l-.33,1.28q-1.44,5.61-2.62,11.31c-.11.53-.21,1-.31,1.58-.28,1.37-.54,2.75-.8,4.14l-.33,1.85c-.23,1.35-.45,2.7-.67,4.05-.09.59-.19,1.18-.27,1.77-.24,1.6-.47,3.2-.68,4.8,0,.33-.09.66-.13,1q-.37,2.93-.67,5.87l-.12,1.28c-.15,1.52-.28,3.05-.41,4.58-.05.64-.09,1.29-.14,1.93-.09,1.34-.18,2.69-.25,4,0,.68-.08,1.36-.11,2-.06,1.4-.11,2.8-.16,4.21,0,.59,0,1.17,0,1.76Q0,247,0,250t.08,6c0,.59,0,1.17.05,1.75,0,1.41.1,2.81.16,4.22,0,.67.07,1.34.1,2,.08,1.36.17,2.72.26,4.07,0,.63.09,1.25.14,1.87.13,1.63.27,3.25.43,4.86l.09,1q.3,2.92.67,5.83c0,.46.12.91.18,1.37.19,1.47.4,2.94.62,4.4.09.63.19,1.25.29,1.88.21,1.32.43,2.64.65,3.95.11.63.22,1.26.34,1.88.26,1.43.53,2.85.81,4.27.1.47.18.94.28,1.4q.58,2.85,1.23,5.66c0,.22.11.44.16.66q.57,2.46,1.2,4.9c.14.56.29,1.12.44,1.68q.51,2,1.05,3.9l.51,1.81c.38,1.32.78,2.63,1.18,3.94.15.51.31,1,.47,1.55q1.71,5.44,3.65,10.79l.52,1.39c.49,1.31,1,2.62,1.49,3.92.22.57.45,1.13.67,1.69.5,1.25,1,2.48,1.52,3.71.22.53.43,1.06.66,1.58q.92,2.16,1.88,4.31l.38.84q1.17,2.61,2.41,5.17l.46.94c.67,1.37,1.34,2.73,2,4.09l.78,1.51c.62,1.19,1.24,2.37,1.87,3.54l.83,1.54c.69,1.26,1.39,2.5,2.1,3.75l.65,1.15q1.43,2.46,2.89,4.89l.09.15c.94,1.54,1.89,3.06,2.86,4.58l.84,1.29q1.11,1.72,2.25,3.42l1,1.44c.77,1.13,1.55,2.25,2.34,3.37l.88,1.25c1.05,1.47,2.11,2.93,3.2,4.38a.36.36,0,0,0,.07.1q1.7,2.28,3.45,4.51l.8,1q1.34,1.7,2.7,3.36l1.08,1.31c.86,1,1.72,2.05,2.6,3.07l1.07,1.24q1.51,1.74,3.05,3.45c.22.23.43.47.64.71,1.28,1.4,2.56,2.78,3.86,4.15l.57.58c1.09,1.14,2.2,2.27,3.31,3.39L74,427.49q1.42,1.42,2.88,2.82l1.24,1.18c1,1,2.06,1.93,3.1,2.89l1,.91q4.15,3.75,8.47,7.33l1.15.94c1.06.88,2.13,1.74,3.21,2.59l1.36,1.07,3.22,2.47,1.26.95c1.37,1,2.74,2,4.13,3l.36.26q2.31,1.63,4.66,3.23l1,.69c1.2.81,2.41,1.6,3.62,2.39l1.46.93c1.12.71,2.24,1.41,3.37,2.1.49.31,1,.61,1.48.9,1.26.77,2.53,1.51,3.8,2.25l1,.6q2.44,1.41,4.94,2.76l.71.38c1.4.75,2.81,1.5,4.23,2.23l1.52.77c1.18.6,2.37,1.19,3.56,1.77l1.65.8c1.23.58,2.46,1.16,3.71,1.73l1.41.65q5.15,2.31,10.4,4.4l1.5.58q1.89.74,3.81,1.44l1.77.65c1.24.45,2.48.89,3.72,1.31l1.7.59c1.49.5,3,1,4.49,1.45l.9.29.25.08h0A250.73,250.73,0,0,0,362.9,473.1h0l.52-.27,1.46-.75c1.16-.61,2.32-1.22,3.47-1.84.59-.31,1.18-.63,1.76-1,1.07-.58,2.12-1.17,3.17-1.77l1.77-1c1.16-.68,2.32-1.36,3.47-2,.43-.27.88-.52,1.31-.79q2.24-1.37,4.44-2.77l2-1.26c.87-.57,1.74-1.14,2.6-1.72s1.45-1,2.16-1.46l2.26-1.57V421.55a5,5,0,0,0-4.95-4.95H356c-3.08,3.15-5.23,6.49-5.17,11.19.09,5.95,3.42,5.31,7.73,16a56.85,56.85,0,0,1,3.93,16.35q-9.62,5.16-19.74,9.45A239.15,239.15,0,0,1,165.84,473a73.07,73.07,0,0,1-5-13.45c-9.81-37.47,14.85-69.23,0-78.89a12.67,12.67,0,0,0-7.29-2,77.15,77.15,0,0,0-9.56,1,97.12,97.12,0,0,1-14,1.05c-1.21,0-2.46,0-3.77-.08-22.2-.89-53.25-6.35-56.2-19.45-1-4.41.88-11.06,2.73-15.18,1.54-3.43,2.66-5.94,5.3-7.23a7.24,7.24,0,0,1,3.24-.73,16.12,16.12,0,0,1,3.23.42,15.57,15.57,0,0,0,3,.42,4.43,4.43,0,0,0,2.53-.71c.5-.34,2.72-2,2.7-9,0-8.86-3.61-15.76-7.2-22-9.68-16.92-11.52-15.47-13.94-22.48-2.9-8.44-4.6-23.26,2.74-29.39,1.65-1.38,4-1.85,7.3-1.85,5.06,0,12.38,1.11,23,1.85,9.5.66,15,1.93,19.33,1.93a15.1,15.1,0,0,0,7.69-1.93c4.5-2.45,6.91-6,8.65-8.64,7.62-11.58,9.91-30.67,1.08-43.23-7.57-10.78-15.84-6.11-25.94-19.45-3.83-5.07-10-13.27-9.73-23.78.18-5.93,2.35-9.77,0-15.13s-7.45-8.06-8.64-8.65a16.88,16.88,0,0,0-7.6-1.74,35.79,35.79,0,0,0-7.26,1,33.49,33.49,0,0,1-6.77,1,11.13,11.13,0,0,1-5.39-1.28c-4.81-2.54-5.46-7.38-8.64-16.21a56.58,56.58,0,0,0-4.19-9.34,240.55,240.55,0,0,1,46-47.64c6.41,4.25,7.15,8.78,17,19.22,9.26,9.76,17.79,15.47,24.86,20.2C170,118.19,177.75,113,184,123.34c9.93,16.38,0,45.06,0,45.06s8.38,15.67,21.75,20.19a25.54,25.54,0,0,0,8.27,1.34,31.08,31.08,0,0,0,8.82-1.34c2.6-.76,11.66-3.4,15.54-10.87,3.24-6.25.74-11.8-1.56-23.31-3.75-18.78-.12-19.13-3.11-32.63-1.66-7.52-5.77-26.12-20.19-38.84-16-14.09-30.86-8.82-37.29-21.75-4.64-9.33,2.16-13.95-1.56-26.41a34.48,34.48,0,0,0-4.51-9.4,238.29,238.29,0,0,1,313,175.2,70.26,70.26,0,0,1-9.63,4.38,45.71,45.71,0,0,1-15.51,2.8c-10.09,0-18.72-3.56-26.93-7.11s-16-7.1-24.47-7.1a30.61,30.61,0,0,0-13.21,3.06c-19.71,9.29-34.62,43.19-31.71,70.11,1.12,10.37,4.91,19.08-.4,27.5-6.26,9.93-19.44,10.41-22.63,22.08a26.83,26.83,0,0,0-.55,9.38,32.14,32.14,0,0,0,5.52,15.46c7.62,10.51,18,7.59,27,19.87a32.23,32.23,0,0,1,3.32,5.51c4.38,9.6,2.28,19,1.1,24.29-.19.84-.41,1.65-.65,2.43h13.81a5,5,0,0,0,4.95-4.95V347.41a5,5,0,0,1,5-5h13.44a5,5,0,0,1,5,5v40.88a5,5,0,0,0,4.95,4.95h33.37c.57-.81,1.12-1.63,1.68-2.45.29-.42.58-.83.86-1.25,1-1.45,1.93-2.91,2.88-4.38l1-1.56c.65-1,1.29-2.05,1.92-3.08l1.09-1.79c.63-1,1.24-2.08,1.85-3.13l.94-1.61q1.31-2.28,2.57-4.6c.23-.42.45-.84.67-1.26.64-1.19,1.27-2.38,1.89-3.58.31-.6.62-1.2.92-1.81.54-1.07,1.08-2.15,1.61-3.23.28-.59.57-1.18.86-1.77q1-2.07,1.94-4.17c.13-.26.25-.53.37-.79.74-1.63,1.45-3.27,2.15-4.92.25-.57.48-1.15.72-1.72.48-1.15.95-2.29,1.41-3.45l.74-1.86c.48-1.25,1-2.51,1.43-3.76.17-.48.36-.95.53-1.43.62-1.69,1.22-3.4,1.8-5.11.17-.49.33-1,.49-1.47.42-1.28.84-2.57,1.25-3.86.2-.62.39-1.24.58-1.86.38-1.24.75-2.48,1.11-3.73.16-.57.33-1.13.49-1.69.49-1.77,1-3.54,1.44-5.33.06-.25.12-.51.19-.76.39-1.56.78-3.13,1.14-4.7.14-.59.28-1.19.41-1.79.29-1.28.57-2.57.84-3.86.13-.6.26-1.21.38-1.82.31-1.54.6-3.08.89-4.63.05-.31.12-.62.17-.93.33-1.85.63-3.7.92-5.56l.24-1.62c.2-1.37.39-2.73.57-4.11.09-.62.17-1.25.24-1.88.18-1.41.34-2.83.49-4.26.05-.5.11-1,.16-1.49q.28-2.85.51-5.71c0-.39.05-.78.08-1.18.11-1.53.21-3.08.29-4.62,0-.62.07-1.25.09-1.87.07-1.4.12-2.79.16-4.19l.06-1.76c0-1.95.07-3.89.07-5.85h0C500,247.71,500,245.44,499.9,243.17Z"/><path class="cls-3" d="M403,83.61a8.66,8.66,0,0,0-5.14-1.47c-4,0-8.81,1.88-13.41,3.73-18.19,7.34-20.62,17.21-30.51,17.21l-.69,0c-6.71-.3-8.81-4.58-16.47-4.58-.52,0-1.06,0-1.63.06-3.11.22-8.68.63-12.21,4.52-7.37,8.14-1,26.17,0,28.95,2.16,6.08,4.29,8.42,3.17,12.21-1.81,6.12-9.16,6.13-9.95,10.85-.89,5.35,7.29,12.76,15.83,14.47a12.17,12.17,0,0,0,2.52.25c3.94,0,8.8-1.6,16.93-4.32,12-4,18-6.09,20.35-9.95,4.57-7.57-2.07-14.36,2.26-19,1.53-1.63,3.51-2,6.31-2,1.33,0,2.84.09,4.57.18s3.68.18,5.88.18a76.35,76.35,0,0,0,12.64-1.05c5.88-1,8.85-1.49,10.4-3.61,3.7-5.08-2.9-11.61-6.33-28.95C405.4,90.31,406.7,86.21,403,83.61Z"/></g><path class="cls-4" d="M404.92,309.84A95.08,95.08,0,1,0,500,404.92,95.08,95.08,0,0,0,404.92,309.84Zm62.47,101.8a5,5,0,0,1-5,5H421.55a5,5,0,0,0-4.95,4.95v40.88a5,5,0,0,1-5,4.95H398.2a5,5,0,0,1-5-4.95V421.55a5,5,0,0,0-4.95-4.95H347.41a5,5,0,0,1-5-5V398.2a5,5,0,0,1,5-5h40.88a5,5,0,0,0,4.95-4.95V347.41a5,5,0,0,1,5-5h13.44a5,5,0,0,1,5,5v40.88a5,5,0,0,0,4.95,4.95h40.88a5,5,0,0,1,5,5Z"/></g></g>
                </svg>
                <div class="rect-slide">
                    <div class="text-wrapper">
                        <div class="text-flex">
                            <b class="planet-name">Create a Planet</b>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <br />

    <h6 class="mt-4 text-center icons-title">Your Friends</h6>
    <div class="icon-container">

        @foreach (var friend in FriendService.Friends)
        {
            <FriendCardComponent @key='"friend-" + friend.Id' Friend="friend" WindowCtx="WindowCtx" HomeWindowComponent="this" />
        }
        
        <div id="flipper-friend-add-@WindowCtx.Id" class="flipper" ontouchstart="determineFlip('flipper-friend-add-@WindowCtx.Id', 240)" onmouseover="determineFlip('flipper-friend-add-@WindowCtx.Id', 240)" @onclick="OnClickAddFriend">
            <div class="outer-circle">
                <div class="text-hide-circle" />
                @if (FriendService.FriendRequests.Count > 0)
                {
                    <div class="noti friends">
                        @FriendService.FriendRequests.Count
                    </div>
                }
                <svg class="icon create" style="border-radius: 0; transform: scale(0.7)" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 500">
                    <defs>
                        <style>
                                .cls-1, .cls-3 {
                                    fill: #fff;
                                }
    
                                .cls-1 {
                                    opacity: 0.1;
                                }
    
                                .cls-2 {
                                    opacity: 0.2;
                                }
    
                                .cls-4 {
                                    fill: #05ff00;
                                }
    
                                .cls-5 {
                                    opacity: 0.3;
                                }
                            </style>
                    </defs>
                    <g id="Layer_2" data-name="Layer 2">
                        <g id="Layer_4" data-name="Layer 4">
                            <path class="cls-4" d="M404.92,309.84A95.08,95.08,0,1,0,500,404.92,95.08,95.08,0,0,0,404.92,309.84Zm62.47,101.8a5,5,0,0,1-5,5H421.55a5,5,0,0,0-4.95,4.95v40.88a5,5,0,0,1-5,4.95H398.2a5,5,0,0,1-5-4.95V421.55a5,5,0,0,0-4.95-4.95H347.41a5,5,0,0,1-5-5V398.2a5,5,0,0,1,5-5h40.88a5,5,0,0,0,4.95-4.95V347.41a5,5,0,0,1,5-5h13.44a5,5,0,0,1,5,5v40.88a5,5,0,0,0,4.95,4.95h40.88a5,5,0,0,1,5,5Z" />
                        </g>
                        <path transform="translate(-80, -90) scale(1.2)" id="Victor" class="cls-1 cls-5" d="M292.63,72.1c-.53,0-1.08,0-1.65.08C159.91,84.87,121.8,225,129.2,273.63c13.08,86,37.26,105.09,127.48,93.58a173.26,173.26,0,0,0,29.11-6.56c-2.63-14.12-7.67-48.34-7.2-101,.61-67.39,12.6-84.27,13.78-85.77,1.68-5.14,33.05-101.95.26-101.8Zm108.76,88.38c-32.06.14-73.22,7.22-94.72,11.38-7.1,12-18.5,38.67-17.43,85.84,1.11,49.08,7,83.09,10.17,98.27,72-27.05,159.92-96.61,146.41-180.3C444,164.09,425.2,160.37,401.39,160.48ZM211.74,180.29h.6c9.81.4,17.32,9.94,16.76,21.3h0c-.56,11.36-9,20.25-18.78,19.85h0c-9.82-.4-17.32-9.93-16.76-21.3h0c.54-11.09,8.59-19.88,18.18-19.86Zm116.5,43.41.59,0c9.82.4,17.32,9.93,16.77,21.3h0c-.56,11.36-9,20.25-18.78,19.85h0c-9.82-.4-17.32-9.94-16.77-21.3.55-11.1,8.59-19.88,18.19-19.87ZM165.52,303c5.68-.07,12.45,1.26,18.38,2.49,14.26,3,23.16,8.78,29.44,18.75,7.9,12.55,24.61,39.48-12.51,32.36-22.13-4.25-40.81-20.92-45.76-34.46-5.48-15,1-19,10.45-19.14ZM361.13,342.6a8.81,8.81,0,0,0-3.65,1.06c-39.84,21.59-98.58,45.08-159.31,38.47-13.59-1.48-28.43,12.92-28.43,12.92s-16.05-8.77-24.43-7.44c-24.61,3.91-32.79,52.17-18.73,64.38,3.93,3.41,15.67,3.53,15.67,3.53s-2.14,10.85-.55,17.63c7.48,31.84,265,26.92,279.31-3.75,10.08-21.58-34.19-128.49-59.88-126.8ZM147.59,393.85c11.47-.35,33.13,12.72,28.33,19.54-6,8.51-5.49,12.36-3.37,22.2S144.48,452.32,135,446.9c-13.26-7.6-5.11-49.32,10.41-52.79a11.83,11.83,0,0,1,2.15-.26Zm53.74,8.91a20.76,20.76,0,0,1,3.15.22c12.07,1.82,20.4,13.8,18.6,26.77S210,451.77,198,450h0c-12.08-1.81-20.41-13.79-18.6-26.76h0c1.62-11.68,11-20.38,22-20.43Zm58.8.72a17.61,17.61,0,0,1,7.28,1.29c13.86,6.62,9.22,48.81-6,53.39-10.38,3.13-36.49-9.4-32-17,5.26-8.92,4.44-12.72,1.51-22.38-2.38-7.84,16.66-15.29,29.18-15.28Z" />
                    </g>
                </svg>
                <div class="rect-slide">
                    <div class="text-wrapper">
                        <div class="text-flex">
                            <b class="planet-name">Manage Friends</b>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
        
    <br />

    <h6 class="mt-4 text-center icons-title">Discover a New Planet!</h6>
    <div class="icon-container">
        @foreach (PlanetListInfo info in Discoverables)
        {
            // Skip already joined planets
            if (PlanetService.JoinedPlanets.Any(x => x.Id == info.PlanetId))
                continue;

            <PlanetDiscoverableComponent @key='"discovery-" + info.PlanetId' PlanetInfo="@info" WindowCtx="WindowCtx"></PlanetDiscoverableComponent>
        }
    </div>

    <br />
</div>

    

@code {
    public static WindowContent<HomeWindowComponent> DefaultContent => new(){
        Icon = "./_content/Valour.Client/media/logo/logo-128.png",
        Title = "Welcome back!"
    };

    [CascadingParameter]
    public ModalRoot ModalRoot { get; set; }

    public List<PlanetListInfo> Discoverables { get; set; } = new ();

    public event Func<Task> OnRerenderFriendCards;

    public event Func<Task> OnRerenderPlanetCards;

    private string _mobileTag = "";

    protected override async Task OnInitializedAsync()
    {
        PlanetService.JoinedPlanetsUpdated += OnJoinedPlanetsUpdate;
        FriendService.FriendsChanged += OnFriendsListUpdate;

        Discoverables = await PlanetService.FetchDiscoverablePlanetsAsync();

        // Render planet and friend cards before unread is loaded
        ReRender();
        
        var unreadPlanetsTask = FetchAndRerenderPlanetsAsync();
        var unreadDirectChannelsTask = FetchAndRerenderDirectChannelsAsync();

        await Task.WhenAll(unreadPlanetsTask, unreadDirectChannelsTask);
    }
    
    private async Task FetchAndRerenderPlanetsAsync()
    {
        await UnreadService.FetchUnreadPlanetsAsync();

        if (OnRerenderPlanetCards is not null)
            await OnRerenderPlanetCards.Invoke();

        ReRender();
    }

    private async Task FetchAndRerenderDirectChannelsAsync()
    {
        await UnreadService.FetchUnreadDirectChannelsAsync();

        if (OnRerenderFriendCards is not null)
            await OnRerenderFriendCards.Invoke();

        ReRender();
    }

    protected override void OnAfterRender(bool firstRender)
    {
        if (firstRender)
        {
            if (DeviceInfo.IsMobile)
            {
                _mobileTag = "mobile";
                ReRender();
            }
        }
        
        base.OnAfterRender(firstRender);
    }

    private Task OnJoinedPlanetsUpdate()
    {
        ReRender();
        return Task.CompletedTask;
    }

    public void OnClickCreatePlanet()
    {
        var data = new CreatePlanetComponent.ModalParams()
        {
            // Window = Window
        };

        ModalRoot.OpenModal<CreatePlanetComponent>(data);
    }

    private void OnClickAddFriend()
    {
        var data = new EditUserComponent.ModalParams()
        {
            StartTopMenu = "General Settings",
            StartSubMenu = "Friends",
            User = Client.Me
        };
        
        ModalRoot.OpenModal<EditUserComponent>(data);
    }
    
    private void FriendEventHandler(FriendEventData eventData)
    {
        ReRender();
    }

    private void OnFriendsListUpdate(FriendEventData e)
    {
        ReRender();
    }
    
}
