using System.Text;
using Valour.Shared.Models;

namespace Valour.Shared.Utilities
{
    public static class PlanetIconSvgGenerator
    {
        /// <summary>
        /// Get Planet HashCode to supply the default icon with the Planet's assigned color.
        /// </summary>
        /// <returns>Returns the default Planet Icon with corrected fill color, or the default svg if the method fails.</returns>
        public static string GetPlanetIconColor(ISharedPlanet planet)
        {
            return GetPlanetIconColor(planet.Id);
        }
        
        /// <summary>
        /// Get Planet HashCode to supply the default icon with the Planet's assigned color.
        /// </summary>
        /// <returns>Returns the default Planet Icon with corrected fill color, or the default svg if the method fails.</returns>
        public static string GetPlanetIconColor(long planetId)
        {
            try
            {
                var planetIconColor = planetId.GetHashCode();
                var rotation = (planetIconColor >> 1) % 360;

                var sb = new StringBuilder();
                sb.Append("<svg class=\"icon\" id=\"svg8\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 567 567\">")
                  .Append("\r\n              <defs>\r\n                  <style>\r\n                  .star {\r\n                    fill: white;\r\n                  }\r\n                  \r\n                  .cls-1-")
                  .Append(planetId)
                  .Append(", .cls-2-")
                  .Append(planetId)
                  .Append(" {\r\n                    fill: hsl(")
                  .Append(planetIconColor)
                  .Append(", 100%, 80%);\r\n                  }\r\n                  \r\n                  .cls-2-")
                  .Append(planetId)
                  .Append(" {\r\n                    isolation: isolate;\r\n                    opacity: .4;\r\n                  }\r\n                \r\n                  </style>\r\n              </defs>")
                  .Append("\r\n              <rect width=\"567\" height=\"567\" x=\"0\" y=\"0\"/>")
                  // Stars layer (static)
                  .Append("\r\n              <circle id=\"Star\" class=\"star\" cx=\"48.6\" cy=\"217.5\" r=\"6.2\"/>\r\n              <circle class=\"star\" cx=\"404.7\" cy=\"65.7\" r=\"6.4\"/>\r\n              <circle class=\"star\" cx=\"528.87\" cy=\"336.5\" r=\"6.1\"/>\r\n              <circle class=\"star\" cx=\"498.3\" cy=\"252.3\" r=\"2.4\"/>\r\n              <circle class=\"star\" cx=\"64.64\" cy=\"402.8\" r=\"2.2\"/>\r\n              <circle class=\"star\" cx=\"191\" cy=\"35.1\" r=\"2.5\"/>\r\n              <circle class=\"star\" cx=\"306.8\" cy=\"527.7\" r=\"5.3\"/>\r\n              <circle class=\"star\" cx=\"199\" cy=\"515.9\" r=\"2.2\"/>\r\n              <circle class=\"star\" cx=\"478.2\" cy=\"405.5\" r=\"2.7\"/>")
                  // Planet layer (rotating)
                  .Append("\r\n              <g id=\"Layer_2\" data-name=\"Layer 2\" transform=\"rotate(")
                  .Append(rotation)
                  .Append(" 283.5 283.5)\">")  // Rotate around center point (567/2 = 283.5)
                  .Append("\r\n                <g id=\"Layer_4\" data-name=\"Layer 4\">\r\n                    ")
                  .Append("<g id=\"Ocean\">\r\n                      <path class=\"cls-2-")
                  .Append(planetId)
                  .Append("\" d=\"m457.2,403.32c24.96-35.59,38.32-78.02,38.25-121.49,0-117.1-94.93-212.04-212.04-212.04s-212.04,94.93-212.04,212.04c0,127.17,114.4,209.37,212.04,212.04,56.16,1.53,99.86-23.45,121.49-38.25,9.58-7.77,18.07-16.28,28.05-25.41,9.18-8.4,16.7-18.56,24.25-26.89Z\"/>\r\n                    </g>\r\n                    ")
                  .Append("<g id=\"Landmass\" class=\"cls-3\">\r\n                      <path class=\"cls-1-")
                  .Append(planetId)
                  .Append("\" d=\"m457.01,403.22c.48-.69.95-1.38,1.42-2.08.25-.36.49-.7.73-1.06.85-1.23,1.64-2.47,2.44-3.71l.85-1.32c.55-.85,1.09-1.74,1.63-2.61l.92-1.52c.53-.85,1.05-1.76,1.57-2.65l.8-1.37c.74-1.29,1.47-2.59,2.18-3.9.2-.36.38-.71.57-1.07.54-1.01,1.08-2.02,1.6-3.04.26-.51.53-1.02.78-1.54.46-.91.92-1.82,1.37-2.74.24-.5.48-1,.73-1.5.57-1.17,1.11-2.35,1.65-3.54.11-.22.21-.45.31-.67.63-1.38,1.23-2.77,1.82-4.17.21-.48.41-.98.61-1.46.41-.98.81-1.94,1.2-2.93l.63-1.58c.41-1.06.85-2.13,1.21-3.19.14-.41.31-.81.45-1.21.53-1.43,1.03-2.88,1.53-4.33.14-.42.28-.85.42-1.25.36-1.09.71-2.18,1.06-3.27.17-.53.33-1.05.49-1.58.32-1.05.64-2.1.94-3.16.14-.48.28-.96.42-1.43.42-1.5.85-3,1.22-4.52.05-.21.1-.43.16-.64.33-1.32.66-2.65.97-3.99.12-.5.24-1.01.35-1.52.25-1.09.48-2.18.71-3.27.11-.51.22-1.03.32-1.54.26-1.31.51-2.61.75-3.93.04-.26.1-.53.14-.79.28-1.57.53-3.14.78-4.72l.2-1.37c.17-1.16.33-2.32.48-3.49.08-.53.14-1.06.2-1.59.15-1.2.29-2.4.42-3.61.04-.42.09-.85.14-1.26.16-1.61.3-3.23.43-4.84,0-.33.04-.66.07-1,.09-1.3.18-2.61.25-3.92,0-.53.06-1.06.08-1.59.06-1.19.1-2.37.14-3.55l.05-1.49c0-1.65.06-3.3.06-4.96-.02-1.94-.02-3.87-.1-5.79,0-.64-.05-1.27-.07-1.91-.05-1.29-.09-2.54-.16-3.85-.04-.75-.1-1.51-.14-2.26-.08-1.15-.15-2.31-.25-3.46-.07-.8-.14-1.59-.21-2.38-.1-1.1-.21-2.21-.33-3.31-.08-.81-.18-1.61-.27-2.42-.13-1.09-.27-2.17-.42-3.26l-.33-2.38c-.16-1.09-.33-2.19-.51-3.27l-.38-2.31c-.2-1.13-.42-2.26-.63-3.39-.14-.71-.26-1.42-.41-2.14-.25-1.26-.53-2.54-.81-3.76l-.31-1.45c-21.52-94.3-105.9-164.69-206.73-164.69-25.58-.02-50.94,4.59-74.87,13.61l-1.75.68-1.7.65c-1.07.42-2.13.85-3.19,1.3l-1.29.54c-1.5.63-2.99,1.28-4.46,1.95l-.2.08c-1.4.64-2.79,1.29-4.17,1.95l-1.33.65c-1.01.49-2,.98-2.99,1.49-.53.26-1.04.53-1.56.81l-2.74,1.44-1.59.85c-.91.5-1.81,1-2.71,1.52l-1.52.85c-.98.57-1.94,1.14-2.9,1.7-.42.25-.85.48-1.23.74-1.37.83-2.73,1.68-4.08,2.54l-.15.09c-1.29.83-2.57,1.68-3.83,2.54l-1.29.85-2.65,1.84-1.48,1.06c-.85.58-1.61,1.16-2.42,1.76l-1.51,1.13c-.79.6-1.59,1.21-2.37,1.82-.48.36-.96.74-1.43,1.11-.85.67-1.7,1.35-2.54,2.04l-1.2.97-.3.25c-12.54,10.45-23.83,22.3-33.66,35.33l-.44.6-.96,1.28c-.63.85-1.26,1.7-1.87,2.54l-.97,1.33c-.64.91-1.26,1.82-1.89,2.73l-.8,1.17c-.85,1.26-1.7,2.54-2.54,3.81-.03.04-.06.08-.08.13-.87,1.35-1.71,2.71-2.54,4.08-.2.33-.4.67-.6,1.01-.62,1.03-1.23,2.05-1.83,3.1l-.74,1.3c-.56.98-1.11,1.97-1.7,2.96-.24.42-.47.85-.7,1.26-.61,1.13-1.2,2.26-1.77,3.39-.15.29-.31.57-.45.85-.74,1.45-1.46,2.91-2.18,4.38l-.1.22c-.65,1.36-1.29,2.73-1.92,4.1-.18.38-.35.77-.52,1.16-.49,1.09-.97,2.18-1.43,3.27l-.56,1.32c-.47,1.1-.92,2.21-1.36,3.32-.16.39-.32.79-.47,1.18-.55,1.42-1.1,2.84-1.63,4.24l-.08.22c-.57,1.55-1.11,3.11-1.65,4.68-.1.29-.2.58-.29.85-.42,1.24-.85,2.49-1.21,3.74-.14.45-.28.9-.42,1.36-.34,1.12-.68,2.24-1,3.39l-.41,1.42c-.34,1.2-.66,2.42-.98,3.64l-.28,1.09c-.81,3.17-1.55,6.37-2.22,9.59-.09.45-.18.85-.26,1.34-.24,1.16-.46,2.33-.68,3.51l-.28,1.57c-.2,1.15-.38,2.29-.57,3.43-.08.5-.16,1-.23,1.5-.2,1.36-.4,2.71-.58,4.07,0,.28-.08.56-.11.85-.21,1.66-.4,3.32-.57,4.98l-.1,1.09c-.13,1.29-.24,2.59-.35,3.88-.04.54-.08,1.09-.12,1.64-.08,1.14-.15,2.28-.21,3.39,0,.58-.07,1.15-.09,1.7-.05,1.19-.09,2.37-.14,3.57v1.49c-.02,1.74-.03,3.45-.03,5.15s.02,3.39.07,5.09c0,.5,0,.99.04,1.48,0,1.2.08,2.38.14,3.58,0,.57.06,1.14.08,1.7.07,1.15.14,2.31.22,3.45,0,.53.08,1.06.12,1.59.11,1.38.23,2.76.36,4.12l.08.85c.17,1.65.36,3.3.57,4.94,0,.39.1.77.15,1.16.16,1.25.34,2.49.53,3.73.08.53.16,1.06.25,1.59.18,1.12.36,2.24.55,3.35.09.53.19,1.07.29,1.59.22,1.21.45,2.42.69,3.62.08.4.15.8.24,1.19.33,1.61.68,3.21,1.04,4.8,0,.19.09.37.14.56.32,1.39.66,2.78,1.02,4.16.12.47.25.95.37,1.42.29,1.13.59,2.23.89,3.31l.43,1.54c.32,1.12.66,2.23,1,3.34.13.43.26.85.4,1.31.97,3.08,2,6.13,3.1,9.15l.44,1.18c.42,1.11.85,2.22,1.26,3.32.19.48.38.96.57,1.43.42,1.06.85,2.1,1.29,3.15.19.45.36.9.56,1.34.52,1.22,1.05,2.44,1.59,3.66l.32.71c.66,1.48,1.34,2.94,2.04,4.38l.39.8c.57,1.16,1.14,2.32,1.7,3.47l.66,1.28c.53,1.01,1.05,2.01,1.59,3l.7,1.31c.59,1.07,1.18,2.12,1.78,3.18l.55.98c.81,1.39,1.63,2.77,2.45,4.15l.08.13c.8,1.31,1.6,2.6,2.43,3.88l.71,1.09c.63.97,1.26,1.94,1.91,2.9l.85,1.22c.65.96,1.31,1.91,1.98,2.86l.75,1.06c.89,1.25,1.79,2.49,2.71,3.71.01.03.03.06.06.08.96,1.29,1.94,2.56,2.93,3.83l.68.85c.76.96,1.52,1.91,2.29,2.85l.92,1.11c.73.85,1.46,1.74,2.21,2.6l.91,1.05c.85.98,1.72,1.96,2.59,2.93.19.2.36.4.54.6,1.09,1.19,2.17,2.36,3.27,3.52l.48.49c.92.97,1.87,1.93,2.81,2.88l1.01.92c.8.8,1.62,1.6,2.44,2.39l1.05,1c.85.85,1.75,1.64,2.63,2.45l.85.77c2.35,2.12,4.74,4.19,7.18,6.22l.98.8c.9.75,1.81,1.48,2.72,2.2l1.15.91,2.73,2.09,1.07.81c1.16.85,2.32,1.7,3.5,2.54l.31.22c1.31.92,2.62,1.83,3.95,2.74l.85.59c1.02.69,2.04,1.36,3.07,2.03l1.24.79c.95.6,1.9,1.2,2.86,1.78.42.26.85.52,1.26.76,1.07.65,2.15,1.28,3.22,1.91l.85.51c1.38.8,2.78,1.58,4.19,2.34l.6.32c1.19.64,2.38,1.27,3.59,1.89l1.29.65c1,.51,2.01,1.01,3.02,1.5l1.4.68c1.04.49,2.09.98,3.15,1.47l1.2.55c2.91,1.31,5.85,2.55,8.82,3.73l1.27.49c1.07.42,2.15.83,3.23,1.22l1.5.55c1.05.38,2.1.75,3.16,1.11l1.44.5c1.26.42,2.54.85,3.81,1.23l.76.25.21.07c52.57,16.21,109.37,11.41,158.48-13.38l.44-.23,1.24-.64c.98-.52,1.97-1.03,2.94-1.56.5-.26,1-.53,1.49-.85.91-.49,1.8-.99,2.69-1.5l1.5-.85c.98-.58,1.97-1.15,2.94-1.7.36-.23.75-.44,1.11-.67,1.27-.77,2.52-1.56,3.77-2.35l1.7-1.07c.74-.48,1.48-.97,2.21-1.46s1.23-.85,1.83-1.24l1.92-1.33c8.61-7.05,17.76-15.18,27.09-24.49,9.61-9.59,17.97-18.97,25.19-27.8-10.62-.53-21.73-1.06-33.29-.86-16.78.29-33.85.87-35,.86l-15.61,19.81c-2.61,2.67-4.44,5.5-4.38,9.49.08,5.05,2.9,4.5,6.56,13.57,1.79,4.43,2.92,9.11,3.33,13.87-5.44,2.92-11.02,5.59-16.74,8.01-47.81,20.11-101.5,21.15-150.04,2.89-1.78-3.65-3.2-7.48-4.24-11.41-8.32-31.78,12.59-58.72,0-66.91-1.84-1.18-4-1.77-6.18-1.7-2.72.11-5.43.4-8.11.85-3.93.58-7.9.88-11.87.89-1.03,0-2.09,0-3.2-.07-18.83-.75-45.16-5.39-47.67-16.5-.85-3.74.75-9.38,2.32-12.87,1.31-2.91,2.26-5.04,4.5-6.13.86-.42,1.8-.63,2.75-.62.92.03,1.84.15,2.74.36.83.2,1.69.32,2.54.36.76.02,1.51-.19,2.15-.6.42-.29,2.31-1.7,2.29-7.63,0-7.51-3.06-13.37-6.11-18.66-8.21-14.35-9.77-13.12-11.82-19.07-2.46-7.16-3.9-19.73,2.32-24.93,1.4-1.17,3.39-1.57,6.19-1.57,4.29,0,10.5.94,19.51,1.57,8.06.56,12.72,1.64,16.39,1.64,2.28.05,4.53-.52,6.52-1.64,3.82-2.08,5.86-5.09,7.34-7.33,6.46-9.82,8.41-26.01.92-36.67-6.42-9.14-13.43-5.18-22-16.5-3.25-4.3-8.48-11.25-8.25-20.17.15-5.03,1.99-8.29,0-12.83-1.99-4.55-6.32-6.84-7.33-7.34-2-.99-4.21-1.49-6.45-1.48-2.08.07-4.14.36-6.16.85-1.88.48-3.8.76-5.74.85-1.59.03-3.16-.34-4.57-1.09-4.08-2.15-4.63-6.26-7.33-13.75-.94-2.74-2.13-5.39-3.55-7.92,11.08-15.2,24.21-28.8,39.01-40.41,5.44,3.6,6.06,7.45,14.42,16.3,7.85,8.28,15.09,13.12,21.08,17.13,21.12,14.05,27.69,9.64,32.99,18.41,8.42,13.89,0,38.22,0,38.22,0,0,7.11,13.29,18.45,17.12,2.26.76,4.63,1.15,7.01,1.14,2.54-.02,5.05-.4,7.48-1.14,2.21-.64,9.89-2.88,13.18-9.22,2.75-5.3.63-10.01-1.32-19.77-3.18-15.93-.1-16.22-2.64-27.67-1.41-6.38-4.89-22.15-17.12-32.94-13.57-11.95-26.17-7.48-31.63-18.45-3.94-7.91,1.83-11.83-1.32-22.4-.86-2.84-2.15-5.52-3.83-7.97,105.16-37.41,220.74,17.51,258.15,122.67,3.01,8.47,5.46,17.13,7.32,25.92-2.63,1.44-5.36,2.68-8.17,3.71-4.21,1.55-8.67,2.35-13.15,2.37-8.56,0-15.88-3.02-22.84-6.03-6.96-3.01-13.57-6.02-20.75-6.02-3.88.02-7.71.9-11.2,2.6-16.72,7.88-29.36,36.63-26.89,59.46.95,8.8,4.16,16.18-.34,23.32-5.31,8.42-16.49,8.83-19.19,18.73-.62,2.6-.78,5.3-.47,7.96.4,4.7,2.01,9.22,4.68,13.11,6.46,8.91,15.27,6.44,22.9,16.85,1.09,1.46,2.04,3.03,2.82,4.67,3.71,8.14,2.52,15.58,1.46,20.05-.34,1.45-.64,2.01-1.07,2.61\"/>\r\n                      <path class=\"cls-1-")
                  .Append(planetId)
                  .Append("\" d=\"m413.18,140.72c-1.29-.86-2.81-1.3-4.36-1.25-3.39,0-7.47,1.59-11.37,3.16-15.43,6.23-17.49,14.6-25.88,14.6h-.59c-5.69-.25-7.47-3.88-13.97-3.88-.44,0-.9,0-1.38.05-2.64.19-7.36.53-10.36,3.83-6.25,6.9-.85,22.2,0,24.55,1.83,5.16,3.64,7.14,2.69,10.36-1.54,5.19-7.77,5.2-8.44,9.2-.75,4.54,6.18,10.82,13.43,12.27.7.14,1.42.22,2.14.21,3.34,0,7.46-1.36,14.36-3.66,10.18-3.39,15.27-5.17,17.26-8.44,3.88-6.42-1.76-12.18,1.92-16.11,1.3-1.38,2.98-1.7,5.35-1.7,1.13,0,2.41.08,3.88.15s3.12.15,4.99.15c3.59,0,7.18-.3,10.72-.89,4.99-.85,7.51-1.26,8.82-3.06,3.14-4.31-2.46-9.85-5.37-24.55-1.8-9.31-.7-12.79-3.83-15Z\"/>\r\n                    </g>\r\n                </g>\r\n              </g>\r\n            </svg>");

                var svgImage = Convert.ToBase64String(Encoding.UTF8.GetBytes(sb.ToString()));
                return $"data:image/svg+xml;base64,{svgImage}";
            }
            catch
            {
                Console.WriteLine("Failed to assign planet icon color, returning default icon.");
                return "_content/Valour.Client/media/logo-circle-icon.svg";
            }
        }
    }
}
